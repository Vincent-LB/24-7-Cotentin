<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<title>Distributeurs alimentaires 24/7 â€“ Cotentin</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css" />

<style>
html, body { margin:0; padding:0; }
#map { height:100vh; width:100%; }
.legend {
  position: absolute;
  bottom: 20px;
  left: 20px;
  background: white;
  padding: 10px 14px;
  border-radius: 8px;
  box-shadow: 0 2px 12px rgba(0,0,0,0.25);
  font-family: Arial, sans-serif;
  font-size: 13px;
  z-index: 1000;
}
.legend div {
  display: flex;
  align-items: center;
  margin-bottom: 6px;
}
.legend span {
  width:22px;
  text-align:center;
  margin-right:8px;
  font-size: 18px;
}
#filters {
  position: absolute;
  top: 20px;
  left: 20px;
  background: white;
  padding: 10px;
  border-radius: 8px;
  box-shadow: 0 2px 12px rgba(0,0,0,0.25);
  z-index: 1000;
  font-family: Arial, sans-serif;
  font-size: 13px;
}
#filters button {
  margin-right: 5px;
  margin-bottom: 5px;
  padding: 5px 10px;
  border: 1px solid #ccc;
  border-radius: 4px;
  background: #f9f9f9;
  cursor: pointer;
}
#filters button:hover {
  background: #e9e9e9;
}
</style>
</head>
<body>

<div id="map"></div>

<div id="filters">
  <button onclick="filterMarkers('all')">Tous</button>
  <button onclick="filterMarkers('pizza')">Pizzas</button>
  <button onclick="filterMarkers('tacos')">Tacos</button>
  <button onclick="filterMarkers('bread')">Pain</button>
  <button onclick="filterMarkers('icecream')">Glaces</button>
  <button onclick="filterMarkers('vegetables')">Fruits & LÃ©gumes</button>
  <button onclick="filterMarkers('seafood')">Fruits de mer</button>
  <button onclick="filterMarkers('meal')">Plats prÃ©parÃ©s</button>
  <button onclick="filterMarkers('farmProducts')">Produits fermiers</button>
  <button onclick="filterMarkers('grocery')">Ã‰piceries</button>
</div>

<div class="legend">
  <div><span>ğŸ•</span> Pizza automatique</div>
  <div><span>ğŸŒ®</span> Tacos automatique</div>
  <div><span>ğŸ¥–</span> Distributeur de pain</div>
  <div><span>ğŸ¦</span> Glaces</div>
  <div><span>ğŸ¥•</span> Fruits & LÃ©gumes</div>
  <div><span>ğŸ¦</span> Fruits de mer</div>
  <div><span>ğŸ²</span> Plats prÃ©parÃ©s</div>
  <div><span>ğŸ„</span> Produits fermiers</div>
  <div><span>ğŸ›’</span> Ã‰piceries</div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js"></script>

<script>
var map = L.map('map').setView([49.55, -1.60], 10);

// Ajout des clusters pour regrouper les marqueurs proches
var markers = L.markerClusterGroup();
var allMarkers = [];

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  maxZoom: 19,
  attribution: 'Â© OpenStreetMap'
}).addTo(map);

// Fonction pour crÃ©er des icÃ´nes avec emojis
function icon(emoji) {
  return L.divIcon({
    html: `<div style='font-size:18px'>${emoji}</div>`,
    className: "",
    iconSize: [20, 20],
    iconAnchor: [10, 20]
  });
}

// IcÃ´nes basÃ©es sur les emojis
var icons = {
  pizza: icon("ğŸ•"),
  tacos: icon("ğŸŒ®"),
  bread: icon("ğŸ¥–"),
  icecream: icon("ğŸ¦"),
  vegetables: icon("ğŸ¥•"),
  seafood: icon("ğŸ¦"),
  meal: icon("ğŸ²"),
  farmProducts: icon("ğŸ„"),
  grocery: icon("ğŸ›’")
};

// Points avec adresses prÃ©cises
var points = [
  // ğŸ• PIZZAS
  ["Pizza automatique â€“ 12 Route de la Hague, 50440 Acqueville", 49.613101, -1.74225, "pizza"],
  ["Pizza automatique â€“ 11 Rue de la Hague, 50440 Beaumont-Hague", 49.66297, -1.857514, "pizza"],
  ["Pizza automatique â€“ Ã‰cole primaire, 50460 Urville-Nacqueville", 49.671606, -1.734109, "pizza"],
  ["Pizza automatique â€“ 17 Rue Gautier, 50550 Saint-Vaast-la-Hougue", 49.588072, -1.267502, "pizza"],
  ["Pizza automatique â€“ 6 Avenue de la RÃ©publique, 50270 Barneville-Carteret", 49.379259, -1.785213, "pizza"],
  ["Pizza automatique â€“ 3 Rue de l'Ancien Garage, 50690 Martinvast", 49.6044, -1.6609, "pizza"],
  ["Pizza automatique â€“ 8 Rue de l'AbbÃ© Saint Pierre, 50330 Saint-Pierre-Ã‰glise", 49.668457, -1.405732, "pizza"],
  ["Pizza automatique â€“ 15 Rue de la Gare, 50360 Picauville", 49.378705, -1.422819, "pizza"],
  ["Pizza automatique â€“ 10 Rue de la Mairie, 50440 Vasteville", 49.594602, -1.773239, "pizza"],
  ["Pizza automatique â€“ 23 Rte du Pont Rose, 50270 Barneville-Carteret", 49.385882, -1.752877, "pizza"],

  // ğŸŒ® TACOS
  ["Distributeur de Tacos â€“ 3 Route du Mont Fanu, 50700 Brix", 49.563191, -1.591372, "tacos"],

  // ğŸ¥– DISTRIBUTEURS DE PAIN
  ["Distributeur de Pain â€“ 5 Rue de la Mairie, 50670 Yvetot-Bocage", 49.491338, -1.501975, "bread"],
  ["Distributeur de Pain â€“ 12 Rue du Bourg, 50440 Jobourg", 49.684476, -1.906458, "bread"],
  ["Distributeur de Pain â€“ 8 Rue de l'Ã‰glise, 50760 Tocqueville", 49.670599, -1.343399, "bread"],

  // ğŸ¦ GLACES
  ["Distributeur Glaces â€“ 2 Place du MarchÃ©, 50270 Barneville-Carteret", 49.365516, -1.76334, "icecream"],

  // ğŸ¥• FRUITS & LÃ‰GUMES
  ["Votre Potager Bio â€“ 10 Rue des Jardins, 50760 Tocqueville", 49.6696, -1.3532, "vegetables"],
  ["Distributeur de Fruits et LÃ©gumes â€“ 5 Rue de la Fontaine, 50700 Saint-Floxel", 49.481303, -1.373555, "vegetables"],
  ["Le Distribpain â€“ 49.6705702, -1.3358568, Tocqueville", 49.6705702, -1.3358568, "meal"],

  // ğŸ¦ FRUITS DE MER
  ["Distributeur de Fruits de Mer â€“ 3 Quai des PÃªcheurs, 50550 Saint-Vaast-la-Hougue", 49.587372, -1.280977, "seafood"],
  ["Distributeur de Fruits de Mer â€“ 23 Route du Pont Rose, 50270 Barneville-Carteret", 49.385882, -1.752877, "seafood"],

  // ğŸ² PLATS PRÃ‰PARÃ‰S
  ["Les Petits Plats d'Arnaud â€“ 18 Rue du Port, 50550 Saint-Vaast-la-Hougue", 49.586241, -1.264635, "meal"],
  ["L'En Bar Quai â€“ 25 Rue de la Mer, 50270 Barneville-Carteret", 49.381387, -1.752358, "meal"],

  // ğŸ„ PRODUITS FERMIERS
  ["Les Distributeurs de Tollevast â€“ 10 Rue de la Ferme, 50470 Tollevast", 49.598191, -1.600585, "farmProducts"],
  ["Distributeur de Pain â€“ 49.4897894, -1.5043271, Yvetot-Bocage", 49.4897894, -1.5043271, "bread"],

  // ğŸ›’ Ã‰PICERIES API
  ["Ã‰picerie Api â€“ 15 Rue de l'Ã‰glise, 50690 Couville", 49.557977, -1.66757, "grocery"],
  ["Ã‰picerie Api â€“ 23 Rue du Centre, 50580 Vicq-sur-Mer", 49.694559, -1.409265, "grocery"]
];

// Ajout des marqueurs avec un lÃ©ger dÃ©calage alÃ©atoire pour Ã©viter les chevauchements
points.forEach(p => {
  var latOffset = (Math.random() - 0.5) * 0.0005;
  var lngOffset = (Math.random() - 0.5) * 0.0005;
  var marker = L.marker([p[1] + latOffset, p[2] + lngOffset], { icon: icons[p[3]] });

  // Ajout de la popup avec mention "Distributeur 24/7" uniquement pour les points ouverts 24h/24
  if (p[3] === "grocery") {
    marker.bindPopup("<strong>" + p[0] + "</strong><br/>Ouvert de 5h Ã  23h");
  } else {
    marker.bindPopup("<strong>" + p[0] + "</strong><br/>Distributeur 24/7");
  }

  marker.type = p[3];
  markers.addLayer(marker);
  allMarkers.push(marker);
});

map.addLayer(markers);

// Fonction pour filtrer les marqueurs
function filterMarkers(type) {
  markers.clearLayers();
  if (type === 'all') {
    allMarkers.forEach(marker => markers.addLayer(marker));
  } else {
    allMarkers.forEach(marker => {
      if (marker.type === type) {
        markers.addLayer(marker);
      }
    });
  }
}
</script>

</body>
</html>

